<?xml version="1.0" encoding="UTF-8"?>

<project name="global-cobertura" basedir=".">

	<target name="global-cobertura-instrument" depends="global-taskdefs"
					unless="test.no.cobertura">
		<delete dir="${global.dir.build.cobertura}" />
		<mkdir dir="${global.dir.build.cobertura}" />

		<cobertura-instrument
				todir="${global.dir.build.cobertura}"
				datafile="${global.dir.build.cobertura}/cobertura.ser">
			<fileset dir="${global.dir.build.classes}">
				<include name="**/*.class" />

				<!-- Exclude most sablecc-generated classes. -->
				<exclude name="**/AnalysisAdapter.class" />
				<exclude name="**/DepthFirstAdapter.class" />
				<exclude name="**/ReversedDepthFirstAdapter.class" />
				<exclude name="**/node/A*.class" />
				<exclude name="**/node/EOF.class" />
				<exclude name="**/node/Node.class" />
				<exclude name="**/node/P*.class" />
				<exclude name="**/node/Start.class" />
				<exclude name="**/node/Switch.class" />
				<exclude name="**/node/Switchable.class" />
				<exclude name="**/node/T*.class" />
				<exclude name="**/node/Token.class" />

			</fileset>
		</cobertura-instrument>

	</target>

	<target name="global-cobertura-report" depends="global-taskdefs"
					unless="test.no.cobertura">
		<cobertura-report
				format="html"
				datafile="${global.dir.build.cobertura}/cobertura.ser"
				destdir="${global.dir.build.reports}/cobertura"
				srcdir="${global.dir.build.java}" />
	</target>


</project>
